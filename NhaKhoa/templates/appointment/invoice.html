{% extends "layouts/base.html" %}
{% block title %}Phiếu khám{% endblock %}

{% block content %}
<h2>Phiếu khám #{{ invoice.id }}</h2>

<p><strong>Bệnh nhân:</strong> {{ invoice.patient_name }}</p>
<p><strong>Bác sĩ:</strong> {{ invoice.doctor_name }}</p>
<p><strong>Ngày khám:</strong> {{ invoice.appointment_date }}</p>

<h4>Dịch vụ</h4>
<p>Phí dịch vụ: <strong>{{ invoice.service_fee }} VND</strong></p>

<h4>Thuốc</h4>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Thuốc</th>
            <th>Giá</th>
            <th>Số lượng</th>
            <th>Tổng</th>
        </tr>
    </thead>
    <tbody>
        {% for m in medicines %}
        <tr>
            <td>{{ m.name }}</td>
            <td>{{ m.price }}</td>
            <td>{{ m.quantity }}</td>
            <td>{{ m.price * m.quantity }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h3>Tổng cộng: <strong>{{ invoice.total_fee }} VND</strong></h3>

<hr>

{% if invoice.payment_status == "Paid" %}
    <div class="alert alert-success">Đã thanh toán ({{ invoice.payment_method }})</div>
{% else %}
    <a href="{{ url_for('pay_momo', appointment_id=invoice.id) }}" class="btn btn-danger">
        Thanh toán MoMo
    </a>

    <a href="{{ url_for('pay_cash', appointment_id=invoice.id) }}" class="btn btn-primary">
        Thanh toán tiền mặt
    </a>
{% endif %}

{% endblock %}
